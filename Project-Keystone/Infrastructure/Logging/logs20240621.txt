[21-06-2024 20:07:29534 +03:00 Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager ] User profile is available. Using '"C:\Users\alexs\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
[21-06-2024 20:07:29912 +03:00 Microsoft.Hosting.Lifetime ] Now listening on: "https://localhost:7298"
[21-06-2024 20:07:29912 +03:00 Microsoft.Hosting.Lifetime ] Now listening on: "http://localhost:5153"
[21-06-2024 20:07:29914 +03:00 Microsoft.Hosting.Lifetime ] Application started. Press Ctrl+C to shut down.
[21-06-2024 20:07:29914 +03:00 Microsoft.Hosting.Lifetime ] Hosting environment: "Development"
[21-06-2024 20:07:29914 +03:00 Microsoft.Hosting.Lifetime ] Content root path: "C:\WorkSpace\NetApps\Project-Keystone\Project-Keystone"
[21-06-2024 20:07:31254 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/index.html""" - null null
[21-06-2024 20:07:31419 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 168.1389ms
[21-06-2024 20:07:31443 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/_framework/aspnetcore-browser-refresh.js""" - null null
[21-06-2024 20:07:31443 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/_vs/browserLink""" - null null
[21-06-2024 20:07:31443 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/swagger-ui.css""" - null null
[21-06-2024 20:07:31477 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/_framework/aspnetcore-browser-refresh.js""" - 200 13768 "application/javascript; charset=utf-8" 34.2207ms
[21-06-2024 20:07:31487 +03:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware ] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
[21-06-2024 20:07:31487 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/swagger-ui.css""" - 499 152034 "text/css" 44.305ms
[21-06-2024 20:07:31512 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/_vs/browserLink""" - 200 null "text/javascript; charset=UTF-8" 68.6086ms
[21-06-2024 20:07:31517 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/favicon-16x16.png""" - null null
[21-06-2024 20:07:31519 +03:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware ] Sending file. Request path: '"/favicon-16x16.png"'. Physical path: '"N/A"'
[21-06-2024 20:07:31519 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/favicon-16x16.png""" - 499 665 "image/png" 2.6275ms
[21-06-2024 20:07:31554 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/v1/swagger.json""" - null null
[21-06-2024 20:07:31632 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 78.146ms
[21-06-2024 20:24:51206 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("10"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT 1"
[21-06-2024 20:24:51236 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("7"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT OBJECT_ID(N'[__EFMigrationsHistory]');"
[21-06-2024 20:24:51237 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("0"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT 1"
[21-06-2024 20:24:51237 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("0"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT OBJECT_ID(N'[__EFMigrationsHistory]');"
[21-06-2024 20:24:51244 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("1"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];"
[21-06-2024 20:24:51251 +03:00 Microsoft.EntityFrameworkCore.Migrations ] Applying migration '"20240621172444_TablesUpdate"'.
[21-06-2024 20:24:51288 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("1"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""DROP INDEX [IX_CATEGORIES_NAME] ON [CATEGORIES];"
[21-06-2024 20:24:51290 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("2"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""CREATE UNIQUE INDEX [IX_CATEGORIES_NAME] ON [CATEGORIES] ([NAME]);"
[21-06-2024 20:24:51291 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("0"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20240621172444_TablesUpdate', N'8.0.5');"
[21-06-2024 20:59:56226 +03:00 Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager ] User profile is available. Using '"C:\Users\alexs\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
[21-06-2024 20:59:56371 +03:00 Microsoft.Hosting.Lifetime ] Now listening on: "https://localhost:7298"
[21-06-2024 20:59:56372 +03:00 Microsoft.Hosting.Lifetime ] Now listening on: "http://localhost:5153"
[21-06-2024 20:59:56373 +03:00 Microsoft.Hosting.Lifetime ] Application started. Press Ctrl+C to shut down.
[21-06-2024 20:59:56374 +03:00 Microsoft.Hosting.Lifetime ] Hosting environment: "Development"
[21-06-2024 20:59:56374 +03:00 Microsoft.Hosting.Lifetime ] Content root path: "C:\WorkSpace\NetApps\Project-Keystone\Project-Keystone"
[21-06-2024 20:59:57939 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/index.html""" - null null
[21-06-2024 20:59:58050 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 113.8414ms
[21-06-2024 20:59:58070 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/swagger-ui.css""" - null null
[21-06-2024 20:59:58070 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/_framework/aspnetcore-browser-refresh.js""" - null null
[21-06-2024 20:59:58074 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/_vs/browserLink""" - null null
[21-06-2024 20:59:58080 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/_framework/aspnetcore-browser-refresh.js""" - 200 13768 "application/javascript; charset=utf-8" 10.1025ms
[21-06-2024 20:59:58084 +03:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware ] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
[21-06-2024 20:59:58085 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/swagger-ui.css""" - 499 152034 "text/css" 15.5254ms
[21-06-2024 20:59:58107 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/_vs/browserLink""" - 200 null "text/javascript; charset=UTF-8" 33.2815ms
[21-06-2024 20:59:58136 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/favicon-16x16.png""" - null null
[21-06-2024 20:59:58138 +03:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware ] Sending file. Request path: '"/favicon-16x16.png"'. Physical path: '"N/A"'
[21-06-2024 20:59:58139 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/favicon-16x16.png""" - 499 665 "image/png" 3.0526ms
[21-06-2024 20:59:58178 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/v1/swagger.json""" - null null
[21-06-2024 20:59:58264 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 86.5134ms
[21-06-2024 21:00:11749 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "POST" "https"://"localhost:7298""""/api/Products""" - "application/json" 222
[21-06-2024 21:00:11752 +03:00 Microsoft.AspNetCore.Cors.Infrastructure.CorsService ] CORS policy execution successful.
[21-06-2024 21:00:11823 +03:00 Microsoft.AspNetCore.Routing.EndpointMiddleware ] Executing endpoint '"Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)"'
[21-06-2024 21:00:11837 +03:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker ] Route matched with "{action = \"AddProduct\", controller = \"Products\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddProduct(Project_Keystone.Api.Models.DTOs.ProductDTOs.ProductCreateDTO)" on controller "Project_Keystone.Api.Controllers.ProductsController" ("Project-Keystone").
[21-06-2024 21:00:11840 +03:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker ] Executed action "Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)" in 1.4609ms
[21-06-2024 21:00:11841 +03:00 Microsoft.AspNetCore.Routing.EndpointMiddleware ] Executed endpoint '"Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)"'
[21-06-2024 21:00:11842 +03:00 Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware ] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'Project_Keystone.Core.Services.Interfaces.IProductService' while attempting to activate 'Project_Keystone.Api.Controllers.ProductsController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method10(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[21-06-2024 21:00:11868 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "POST" "https"://"localhost:7298""""/api/Products""" - 500 null "text/plain; charset=utf-8" 119.5622ms
[21-06-2024 21:01:21584 +03:00 Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager ] User profile is available. Using '"C:\Users\alexs\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
[21-06-2024 21:01:21760 +03:00 Microsoft.Hosting.Lifetime ] Now listening on: "https://localhost:7298"
[21-06-2024 21:01:21762 +03:00 Microsoft.Hosting.Lifetime ] Now listening on: "http://localhost:5153"
[21-06-2024 21:01:21763 +03:00 Microsoft.Hosting.Lifetime ] Application started. Press Ctrl+C to shut down.
[21-06-2024 21:01:21764 +03:00 Microsoft.Hosting.Lifetime ] Hosting environment: "Development"
[21-06-2024 21:01:21765 +03:00 Microsoft.Hosting.Lifetime ] Content root path: "C:\WorkSpace\NetApps\Project-Keystone\Project-Keystone"
[21-06-2024 21:01:23398 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/index.html""" - null null
[21-06-2024 21:01:23509 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/index.html""" - 200 null "text/html;charset=utf-8" 113.7028ms
[21-06-2024 21:01:23530 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/_framework/aspnetcore-browser-refresh.js""" - null null
[21-06-2024 21:01:23530 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/_vs/browserLink""" - null null
[21-06-2024 21:01:23530 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/swagger-ui.css""" - null null
[21-06-2024 21:01:23539 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/_framework/aspnetcore-browser-refresh.js""" - 200 13768 "application/javascript; charset=utf-8" 9.5104ms
[21-06-2024 21:01:23547 +03:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware ] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
[21-06-2024 21:01:23548 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/swagger-ui.css""" - 499 152034 "text/css" 18.1945ms
[21-06-2024 21:01:23563 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/_vs/browserLink""" - 200 null "text/javascript; charset=UTF-8" 33.1247ms
[21-06-2024 21:01:23651 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/v1/swagger.json""" - null null
[21-06-2024 21:01:23738 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/v1/swagger.json""" - 200 null "application/json;charset=utf-8" 86.6971ms
[21-06-2024 21:01:23756 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/favicon-16x16.png""" - null null
[21-06-2024 21:01:23757 +03:00 Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware ] Sending file. Request path: '"/favicon-16x16.png"'. Physical path: '"N/A"'
[21-06-2024 21:01:23758 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "GET" "https"://"localhost:7298""""/swagger/favicon-16x16.png""" - 499 665 "image/png" 2.5518ms
[21-06-2024 21:01:26363 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "POST" "https"://"localhost:7298""""/api/Products""" - "application/json" 222
[21-06-2024 21:01:26366 +03:00 Microsoft.AspNetCore.Cors.Infrastructure.CorsService ] CORS policy execution successful.
[21-06-2024 21:01:26414 +03:00 Microsoft.AspNetCore.Routing.EndpointMiddleware ] Executing endpoint '"Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)"'
[21-06-2024 21:01:26428 +03:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker ] Route matched with "{action = \"AddProduct\", controller = \"Products\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddProduct(Project_Keystone.Api.Models.DTOs.ProductDTOs.ProductCreateDTO)" on controller "Project_Keystone.Api.Controllers.ProductsController" ("Project-Keystone").
[21-06-2024 21:01:27852 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("35"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = Binary), @p4='?' (Size = 100), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [PRODUCTS] ([CATEGORY_ID], [CREATED_AT], [DESCRIPTION], [IMAGE_DATA], [NAME], [PRICE], [UPDATED_AT])
OUTPUT INSERTED.[PRODUCT_ID]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);"
[21-06-2024 21:01:27881 +03:00 Microsoft.EntityFrameworkCore.Update ] An exception occurred in the database while saving changes for context type '"Project_Keystone.Infrastructure.Data.ProjectKeystoneDbContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint \"FK_PRODUCTS_CATEGORIES_CATEGORY_ID\". The conflict occurred in database \"ProjectKeystone\", table \"dbo.CATEGORIES\", column 'CATEGORY_ID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:35493556-49b8-4ddc-9907-b2cfa47f00b1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_PRODUCTS_CATEGORIES_CATEGORY_ID". The conflict occurred in database "ProjectKeystone", table "dbo.CATEGORIES", column 'CATEGORY_ID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:35493556-49b8-4ddc-9907-b2cfa47f00b1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
[21-06-2024 21:01:27943 +03:00 Project_Keystone.Core.Services.ProductService ] Error adding product.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_PRODUCTS_CATEGORIES_CATEGORY_ID". The conflict occurred in database "ProjectKeystone", table "dbo.CATEGORIES", column 'CATEGORY_ID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:35493556-49b8-4ddc-9907-b2cfa47f00b1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Project_Keystone.Infrastructure.Repositories.UnitOfWork.CommitAsync() in C:\WorkSpace\NetApps\Project-Keystone\Project-Keystone\Infrastructure\Repositories\UnitOfWork.cs:line 41
   at Project_Keystone.Core.Services.ProductService.AddProductsAsync(ProductCreateDTO productDto) in C:\WorkSpace\NetApps\Project-Keystone\Project-Keystone\Core\Services\ProductService.cs:line 29
[21-06-2024 21:01:27952 +03:00 Project_Keystone.Api.Controllers.ProductsController ] Error adding product.
[21-06-2024 21:01:27956 +03:00 Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor ] Executing "ObjectResult", writing value of type '"System.String"'.
[21-06-2024 21:01:27959 +03:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker ] Executed action "Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)" in 1528.6058ms
[21-06-2024 21:01:27960 +03:00 Microsoft.AspNetCore.Routing.EndpointMiddleware ] Executed endpoint '"Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)"'
[21-06-2024 21:01:27964 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "POST" "https"://"localhost:7298""""/api/Products""" - 500 null "text/plain; charset=utf-8" 1601.1129ms
[21-06-2024 21:02:02012 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request starting "HTTP/2" "POST" "https"://"localhost:7298""""/api/Products""" - "application/json" 222
[21-06-2024 21:02:02013 +03:00 Microsoft.AspNetCore.Cors.Infrastructure.CorsService ] CORS policy execution successful.
[21-06-2024 21:02:02015 +03:00 Microsoft.AspNetCore.Routing.EndpointMiddleware ] Executing endpoint '"Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)"'
[21-06-2024 21:02:02015 +03:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker ] Route matched with "{action = \"AddProduct\", controller = \"Products\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddProduct(Project_Keystone.Api.Models.DTOs.ProductDTOs.ProductCreateDTO)" on controller "Project_Keystone.Api.Controllers.ProductsController" ("Project-Keystone").
[21-06-2024 21:02:02063 +03:00 Microsoft.EntityFrameworkCore.Database.Command ] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = Binary), @p4='?' (Size = 100), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = DateTime2)"], CommandType='Text', CommandTimeout='30']"
""SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [PRODUCTS] ([CATEGORY_ID], [CREATED_AT], [DESCRIPTION], [IMAGE_DATA], [NAME], [PRICE], [UPDATED_AT])
OUTPUT INSERTED.[PRODUCT_ID]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);"
[21-06-2024 21:02:02077 +03:00 Project_Keystone.Core.Services.ProductService ] Product added successfully.
[21-06-2024 21:02:02078 +03:00 Project_Keystone.Api.Controllers.ProductsController ] Product added successfully.
[21-06-2024 21:02:02078 +03:00 Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor ] Executing "OkObjectResult", writing value of type '"System.String"'.
[21-06-2024 21:02:02079 +03:00 Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker ] Executed action "Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)" in 62.9077ms
[21-06-2024 21:02:02082 +03:00 Microsoft.AspNetCore.Routing.EndpointMiddleware ] Executed endpoint '"Project_Keystone.Api.Controllers.ProductsController.AddProduct (Project-Keystone)"'
[21-06-2024 21:02:02082 +03:00 Microsoft.AspNetCore.Hosting.Diagnostics ] Request finished "HTTP/2" "POST" "https"://"localhost:7298""""/api/Products""" - 200 null "text/plain; charset=utf-8" 70.6189ms
